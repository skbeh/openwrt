From 5f422a769e7fb5d8b6c201027d4e2ace421cd693 Mon Sep 17 00:00:00 2001
From: skbeh <60107333+skbeh@users.noreply.github.com>
Date: Sun, 12 Jun 2022 14:34:30 +0800
Subject: [PATCH] Allow build on kernel 5.10

Signed-off-by: skbeh <60107333+skbeh@users.noreply.github.com>
---
 crypto/mtk-eip93/eip93-aead.c   | 6 ++++++
 crypto/mtk-eip93/eip93-common.c | 7 +++++++
 2 files changed, 13 insertions(+)

diff --git a/crypto/mtk-eip93/eip93-aead.c b/crypto/mtk-eip93/eip93-aead.c
index a8521c7..32329f2 100644
--- a/crypto/mtk-eip93/eip93-aead.c
+++ b/crypto/mtk-eip93/eip93-aead.c
@@ -13,8 +13,14 @@
 #include <crypto/internal/aead.h>
 #include <crypto/md5.h>
 #include <crypto/null.h>
+
+#include <linux/version.h>
+#if LINUX_VERSION_CODE < KERNEL_VERSION(5,11,0)
+#include <crypto/sha.h>
+#else
 #include <crypto/sha1.h>
 #include <crypto/sha2.h>
+#endif
 
 #if IS_ENABLED(CONFIG_CRYPTO_DEV_EIP93_DES)
 #include <crypto/internal/des.h>
diff --git a/crypto/mtk-eip93/eip93-common.c b/crypto/mtk-eip93/eip93-common.c
index 641c727..419de4e 100644
--- a/crypto/mtk-eip93/eip93-common.c
+++ b/crypto/mtk-eip93/eip93-common.c
@@ -8,8 +8,15 @@
 #include <crypto/aes.h>
 #include <crypto/ctr.h>
 #include <crypto/hmac.h>
+
+#include <linux/version.h>
+#if LINUX_VERSION_CODE < KERNEL_VERSION(5,11,0)
+#include <crypto/sha.h>
+#else
 #include <crypto/sha1.h>
 #include <crypto/sha2.h>
+#endif
+
 #include <linux/delay.h>
 #include <linux/dma-mapping.h>
 #include <linux/scatterlist.h>
-- 
2.36.1

